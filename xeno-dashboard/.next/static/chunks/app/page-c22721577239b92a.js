(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1774:(e,t,r)=>{Promise.resolve().then(r.bind(r,1871))},1871:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var o=r(5155),n=r(2115),i=r(63),s=r(9858),d=r(6991),l=r(19),a=r(8425),c=r(7734),m=r(4595),h=r(3420),u=r(46),g=r(9585),x=r(8128),f=r(8155);function p(e){let{apiData:t=[],startDate:r,endDate:i,setStartDate:s,setEndDate:p,isLoading:b=!1}=e,[y,j]=(0,n.useState)("line"),[v,S]=(0,n.useState)([]);console.log("\uD83D\uDD27 Raw API Data:",t),(0,n.useEffect)(()=>{if(t&&t.length>0){let e=D(t);S(e),console.log("\uD83D\uDD27 Aggregated Data:",e)}else S([])},[t]);let D=e=>{let t={};return e.forEach(e=>{let r=e.date;t[r]||(t[r]={date:r,orderCount:0,totalRevenue:0}),t[r].orderCount+=parseInt(e.orderCount||0),t[r].totalRevenue+=parseFloat(e.totalRevenue||0)}),Object.values(t).sort((e,t)=>new Date(e.date)-new Date(t.date))},k=e=>{try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(t){return e}},w=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),C=v.reduce((e,t)=>e+(t.orderCount||0),0),R=v.reduce((e,t)=>e+(t.totalRevenue||0),0),z=C>0?R/C:0,A=v&&v.length>0;return console.log("\uD83D\uDD27 Chart has aggregated data:",A,"Length:",v.length),(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",marginBottom:"2rem",minHeight:"600px"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",flexWrap:"wrap",gap:"1rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937",margin:"0 0 0.5rem 0"},children:"\uD83D\uDCC8 Orders Analytics"}),(0,o.jsx)("p",{style:{color:"#6b7280",fontSize:"0.875rem",margin:0},children:"Track your store's order trends and revenue performance"})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,o.jsx)("button",{onClick:()=>j("line"),disabled:!A,style:{padding:"0.5rem 1rem",border:"none",borderRadius:"0.5rem",background:"line"===y?"#3b82f6":"#e5e7eb",color:"line"===y?"white":"#6b7280",cursor:A?"pointer":"not-allowed",fontSize:"0.875rem",fontWeight:"600",opacity:A?1:.5},children:"\uD83D\uDCC8 Line"}),(0,o.jsx)("button",{onClick:()=>j("bar"),disabled:!A,style:{padding:"0.5rem 1rem",border:"none",borderRadius:"0.5rem",background:"bar"===y?"#3b82f6":"#e5e7eb",color:"bar"===y?"white":"#6b7280",cursor:A?"pointer":"not-allowed",fontSize:"0.875rem",fontWeight:"600",opacity:A?1:.5},children:"\uD83D\uDCCA Bar"})]})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{style:{background:"#f8fafc",padding:"1rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Total Orders"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937"},children:A?C.toLocaleString():"0"})]}),(0,o.jsxs)("div",{style:{background:"#f8fafc",padding:"1rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Total Revenue"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#16a34a"},children:A?w(R):"$0.00"})]}),(0,o.jsxs)("div",{style:{background:"#f8fafc",padding:"1rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Avg Order Value"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#8b5cf6"},children:A?w(z):"$0.00"})]}),(0,o.jsxs)("div",{style:{background:"#f8fafc",padding:"1rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Days with Data"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#f59e0b"},children:A?v.length:"0"})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",alignItems:"center",flexWrap:"wrap"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"Start Date"}),(0,o.jsx)("input",{type:"date",value:r||"2025-08-01",onChange:e=>s&&s(e.target.value),style:{padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.25rem",fontSize:"0.875rem"}})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"End Date"}),(0,o.jsx)("input",{type:"date",value:i||"2025-09-15",onChange:e=>p&&p(e.target.value),style:{padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.25rem",fontSize:"0.875rem"}})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"end"},children:[(0,o.jsx)("button",{onClick:()=>{let e=new Date,t=new Date(e);t.setDate(e.getDate()-7),s&&s(t.toISOString().split("T")[0]),p&&p(e.toISOString().split("T")[0])},style:{padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.25rem",background:"white",cursor:"pointer",fontSize:"0.75rem"},children:"Last 7 Days"}),(0,o.jsx)("button",{onClick:()=>{let e=new Date,t=new Date(e);t.setDate(e.getDate()-30),s&&s(t.toISOString().split("T")[0]),p&&p(e.toISOString().split("T")[0])},style:{padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.25rem",background:"white",cursor:"pointer",fontSize:"0.75rem"},children:"Last 30 Days"})]})]}),(0,o.jsx)("div",{style:{height:"400px",width:"100%",border:"1px solid #e5e7eb",borderRadius:"0.5rem",padding:"1rem"},children:b?(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#6b7280"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"⏳"}),(0,o.jsx)("p",{children:"Loading orders data..."})]})}):A?(0,o.jsx)(d.u,{width:"100%",height:350,children:"line"===y?(0,o.jsxs)(l.b,{data:v,margin:{top:20,right:30,left:20,bottom:20},children:[(0,o.jsx)(a.d,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),(0,o.jsx)(c.W,{dataKey:"date",tickFormatter:k,stroke:"#6b7280",fontSize:12,angle:-45,textAnchor:"end",height:60}),(0,o.jsx)(m.h,{yAxisId:"orders",orientation:"left",stroke:"#3b82f6",fontSize:12}),(0,o.jsx)(m.h,{yAxisId:"revenue",orientation:"right",stroke:"#10b981",fontSize:12,tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,o.jsx)(h.m,{formatter:(e,t)=>["orderCount"===t?e:w(e),"orderCount"===t?"Orders":"Revenue"],labelFormatter:e=>"Date: ".concat(k(e)),contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),(0,o.jsx)(u.s,{}),(0,o.jsx)(g.N,{yAxisId:"orders",type:"monotone",dataKey:"orderCount",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:4},name:"Orders"}),(0,o.jsx)(g.N,{yAxisId:"revenue",type:"monotone",dataKey:"totalRevenue",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",strokeWidth:2,r:4},name:"Revenue"})]}):(0,o.jsxs)(x.E,{data:v,margin:{top:20,right:30,left:20,bottom:20},children:[(0,o.jsx)(a.d,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),(0,o.jsx)(c.W,{dataKey:"date",tickFormatter:k,stroke:"#6b7280",fontSize:12,angle:-45,textAnchor:"end",height:60}),(0,o.jsx)(m.h,{yAxisId:"orders",orientation:"left",stroke:"#3b82f6",fontSize:12}),(0,o.jsx)(m.h,{yAxisId:"revenue",orientation:"right",stroke:"#10b981",fontSize:12,tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,o.jsx)(h.m,{formatter:(e,t)=>["orderCount"===t?e:w(e),"orderCount"===t?"Orders":"Revenue"],labelFormatter:e=>"Date: ".concat(k(e)),contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),(0,o.jsx)(u.s,{}),(0,o.jsx)(f.y,{yAxisId:"orders",dataKey:"orderCount",fill:"#3b82f6",name:"Orders",radius:[2,2,0,0]}),(0,o.jsx)(f.y,{yAxisId:"revenue",dataKey:"totalRevenue",fill:"#10b981",name:"Revenue",radius:[2,2,0,0]})]})}):(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#6b7280"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem",opacity:.5},children:"\uD83D\uDCCA"}),(0,o.jsx)("h3",{style:{margin:"0 0 0.5rem 0"},children:"No Orders Data Available"}),(0,o.jsx)("p",{style:{margin:0,fontSize:"0.875rem"},children:"Try adjusting your date range or sync your orders data."}),(0,o.jsx)("button",{onClick:()=>window.location.reload(),style:{marginTop:"1rem",padding:"0.5rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"0.5rem",cursor:"pointer"},children:"\uD83D\uDD04 Refresh Data"})]})})}),(0,o.jsxs)("div",{style:{marginTop:"1rem",padding:"0.5rem",background:"#f3f4f6",borderRadius:"0.25rem",fontSize:"0.75rem",color:"#6b7280"},children:[(0,o.jsx)("strong",{children:"\uD83D\uDD27 Debug:"})," Raw data: ",t.length,", Aggregated: ",v.length,", Loading: ",b?"Yes":"No"]}),A&&(0,o.jsxs)("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#d1fae5",borderRadius:"0.5rem",fontSize:"0.875rem",color:"#065f46"},children:[(0,o.jsx)("strong",{children:"\uD83D\uDCCA Real Data:"})," Showing ",v.length," days of aggregated order data from your Shopify store (combined from ",t.length," raw entries)"]})]})}var b=r(2723),y=r(4035),j=r(9386);function v(e){var t,r,i,s,p,v,S;let{salesData:D=[],customerData:k=[],productData:w=[],isLoading:C=!1}=e,[R,z]=(0,n.useState)({topProducts:[],salesTrends:[],customerInsights:{totalCustomers:0,returningCustomers:0,avgOrderValue:0,retentionRate:0},revenueMetrics:{totalRevenue:0,netRevenue:0,avgMonthlyGrowth:0,profitMargin:0},orderStats:{totalOrders:0,avgOrdersPerDay:0}}),[A,I]=(0,n.useState)("overview");(0,n.useEffect)(()=>{B()},[D,k,w]);let B=()=>{try{var e,t,r;let o=w&&w.length>0?w.map(e=>({name:e.name||e.title||"Unknown Product",revenue:(e.unitsSold||0)*(e.price||50),unitsSold:e.unitsSold||Math.floor(100*Math.random())+10,inventory:e.inventory||Math.floor(200*Math.random())+50,growthRate:Math.floor(40*Math.random())-10,conversionRate:Math.floor(15*Math.random())+5})).sort((e,t)=>t.revenue-e.revenue).slice(0,5):[],n=k&&k.length>0?k.reduce((e,t)=>e+(t.newCustomers||0),0):0,i=k&&k.length>0?k.reduce((e,t)=>e+(t.returningCustomers||0),0):0,s=D&&D.length>0?D.reduce((e,t)=>e+(t.grossRevenue||0),0):0,d=D&&D.length>0?D.reduce((e,t)=>e+(t.netRevenue||0),0):0,l=D&&D.length>0?D.reduce((e,t)=>e+(t.orderCount||0),0):0,a={totalRevenue:s,netRevenue:d,avgMonthlyGrowth:D&&D.length>1?(((null==(e=D[0])?void 0:e.netRevenue)||0)-((null==(t=D[D.length-1])?void 0:t.netRevenue)||0))/Math.max((null==(r=D[D.length-1])?void 0:r.netRevenue)||1,1)*100:0,profitMargin:s>0?d/s*100:0},c={totalOrders:l,avgOrdersPerDay:D&&D.length>0?l/D.length:0};z({topProducts:o,salesTrends:D&&D.length>0?D.slice(0,6).reverse():[],customerInsights:{totalCustomers:n,returningCustomers:i,avgOrderValue:l>0?d/l:0,retentionRate:n>0?i/n*100:0},revenueMetrics:a,orderStats:c})}catch(e){console.error("Error processing analytics data:",e)}},W=e=>{let t="number"!=typeof e||isNaN(e)?0:e;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)},T=e=>("number"!=typeof e||isNaN(e)?0:e).toLocaleString(),N=e=>{if("string"==typeof e&&e.includes("-")){let[t,r]=e.split("-");return new Date(t,r-1).toLocaleDateString("en-US",{year:"numeric",month:"short"})}return e},O=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#6366f1"];return C?(0,o.jsx)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",textAlign:"center",minHeight:"600px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\uD83D\uDCCA"}),(0,o.jsx)("p",{style:{color:"#6b7280",fontSize:"1.1rem"},children:"Loading business analytics..."})]})}):(0,o.jsxs)("div",{style:{display:"grid",gap:"2rem"},children:[(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937",margin:0},children:"\uD83D\uDE80 Smart Business Analytics"}),(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"Real-time insights from your Shopify store"})]}),(0,o.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem"},children:[{id:"overview",label:"\uD83D\uDCCA Overview"},{id:"products",label:"\uD83C\uDFC6 Top Products"},{id:"inventory",label:"\uD83D\uDCE6 Inventory"},{id:"trends",label:"\uD83D\uDCC8 Trends"},{id:"customers",label:"\uD83D\uDC65 Customers"}].map(e=>(0,o.jsx)("button",{onClick:()=>I(e.id),style:{padding:"0.75rem 1rem",border:"none",borderRadius:"0.5rem",background:A===e.id?"#3b82f6":"#f3f4f6",color:A===e.id?"white":"#6b7280",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600",transition:"all 0.2s ease"},children:e.label},e.id))}),"products"===A&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,o.jsx)("h3",{style:{margin:0,color:"#1f2937"},children:"\uD83C\uDFC6 Top Performing Products"}),(0,o.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["\uD83D\uDCE6 Total Orders: ",T((null==(t=R.orderStats)?void 0:t.totalOrders)||0)]})]}),R.topProducts&&R.topProducts.length>0?(0,o.jsx)("div",{style:{overflowX:"auto"},children:(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#f8fafc"},children:[(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Rank"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Product"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid #e5e7eb"},children:"Revenue"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid #e5e7eb"},children:"Units Sold"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid #e5e7eb"},children:"Orders"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #e5e7eb"},children:"Growth"})]})}),(0,o.jsx)("tbody",{children:R.topProducts.map((e,t)=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[(0,o.jsx)("td",{style:{padding:"0.75rem"},children:(0,o.jsx)("div",{style:{width:"2rem",height:"2rem",borderRadius:"50%",background:0===t?"#fbbf24":1===t?"#9ca3af":2===t?"#d97706":"#e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"0.875rem"},children:t+1})}),(0,o.jsx)("td",{style:{padding:"0.75rem",fontWeight:"600"},children:e.name}),(0,o.jsx)("td",{style:{padding:"0.75rem",textAlign:"right",color:"#16a34a",fontWeight:"bold"},children:W(e.revenue)}),(0,o.jsx)("td",{style:{padding:"0.75rem",textAlign:"right"},children:e.unitsSold}),(0,o.jsx)("td",{style:{padding:"0.75rem",textAlign:"right"},children:Math.floor(e.unitsSold/3)}),(0,o.jsx)("td",{style:{padding:"0.75rem",textAlign:"center"},children:(0,o.jsxs)("span",{style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",fontSize:"0.75rem",fontWeight:"600",background:e.growthRate>=0?"#d1fae5":"#fee2e2",color:e.growthRate>=0?"#065f46":"#dc2626"},children:[e.growthRate>=0?"+":"",e.growthRate,"%"]})})]},t))})]})}):(0,o.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:[(0,o.jsx)("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"\uD83D\uDCE6"}),(0,o.jsx)("p",{children:"No product data available. Sync your products to see top performers."})]})]}),"inventory"===A&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{marginBottom:"1rem",color:"#1f2937"},children:"\uD83D\uDCE6 Product Inventory Analysis"}),R.topProducts&&R.topProducts.length>0?(0,o.jsx)("div",{children:(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{style:{padding:"1.5rem",background:"#f8fafc",borderRadius:"1rem"},children:[(0,o.jsx)("h4",{style:{margin:"0 0 1rem 0",color:"#1f2937"},children:"\uD83E\uDD67 Inventory Distribution"}),(0,o.jsx)("div",{style:{height:"300px"},children:(0,o.jsx)(d.u,{width:"100%",height:"100%",children:(0,o.jsxs)(b.r,{children:[(0,o.jsx)(y.F,{data:R.topProducts,cx:"50%",cy:"50%",outerRadius:80,dataKey:"inventory",label:e=>{let{name:t,percent:r}=e;return"".concat(t,": ").concat((100*r).toFixed(0),"%")},children:R.topProducts.map((e,t)=>(0,o.jsx)(j.f,{fill:O[t%O.length]},"cell-".concat(t)))}),(0,o.jsx)(h.m,{formatter:(e,t)=>["".concat(e," units"),"Inventory"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),(0,o.jsx)(u.s,{})]})})})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"white",padding:"1rem",borderRadius:"1rem",textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"0.25rem"},children:"✅"}),(0,o.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:R.topProducts.filter(e=>e.inventory>100).length}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.9},children:"In Stock"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #f59e0b, #d97706)",color:"white",padding:"1rem",borderRadius:"1rem",textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"0.25rem"},children:"⚠️"}),(0,o.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:R.topProducts.filter(e=>e.inventory>50&&e.inventory<=100).length}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Low Stock"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"white",padding:"1rem",borderRadius:"1rem",textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"0.25rem"},children:"\uD83D\uDEA8"}),(0,o.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:R.topProducts.filter(e=>e.inventory<=50).length}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Critical"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",color:"white",padding:"1rem",borderRadius:"1rem",textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"0.25rem"},children:"\uD83D\uDCE6"}),(0,o.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:R.topProducts.reduce((e,t)=>e+(t.inventory||0),0).toLocaleString()}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Total Units"})]})]})]})}):(0,o.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:[(0,o.jsx)("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"\uD83D\uDCE6"}),(0,o.jsx)("p",{children:"No inventory data available."})]})]}),"trends"===A&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{marginBottom:"1rem",color:"#1f2937"},children:"\uD83D\uDCC8 Sales & Orders Trends"}),R.salesTrends&&R.salesTrends.length>0?(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,o.jsx)("h4",{style:{marginBottom:"1rem",color:"#1f2937"},children:"\uD83D\uDCE6 Orders Volume Trend"}),(0,o.jsx)("div",{style:{height:"250px",width:"100%"},children:(0,o.jsx)(d.u,{width:"100%",height:"100%",children:(0,o.jsxs)(x.E,{data:R.salesTrends,children:[(0,o.jsx)(a.d,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),(0,o.jsx)(c.W,{dataKey:"period",stroke:"#6b7280",fontSize:12}),(0,o.jsx)(m.h,{stroke:"#6b7280",fontSize:12}),(0,o.jsx)(h.m,{formatter:(e,t)=>[e,"Orders"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),(0,o.jsx)(u.s,{}),(0,o.jsx)(f.y,{dataKey:"orderCount",fill:"#f59e0b",name:"Orders",radius:[2,2,0,0]})]})})})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{style:{marginBottom:"1rem",color:"#1f2937"},children:"\uD83D\uDCB0 Revenue Trend"}),(0,o.jsx)("div",{style:{height:"300px",width:"100%"},children:(0,o.jsx)(d.u,{width:"100%",height:"100%",children:(0,o.jsxs)(l.b,{data:R.salesTrends,children:[(0,o.jsx)(a.d,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),(0,o.jsx)(c.W,{dataKey:"period",stroke:"#6b7280",fontSize:12}),(0,o.jsx)(m.h,{stroke:"#6b7280",fontSize:12}),(0,o.jsx)(h.m,{formatter:(e,t)=>[W(e),"grossRevenue"===t?"Gross Revenue":"Net Revenue"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),(0,o.jsx)(u.s,{}),(0,o.jsx)(g.N,{type:"monotone",dataKey:"grossRevenue",stroke:"#3b82f6",strokeWidth:3,name:"Gross Revenue"}),(0,o.jsx)(g.N,{type:"monotone",dataKey:"netRevenue",stroke:"#10b981",strokeWidth:3,name:"Net Revenue"})]})})})]})]}):(0,o.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:[(0,o.jsx)("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"\uD83D\uDCC8"}),(0,o.jsx)("p",{children:"No sales trend data available."})]})]}),"customers"===A&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{marginBottom:"1rem",color:"#1f2937"},children:"\uD83D\uDC65 Customer Analytics"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{style:{padding:"1.5rem",background:"#f8fafc",borderRadius:"1rem"},children:[(0,o.jsx)("h4",{style:{margin:"0 0 1rem 0",color:"#1f2937"},children:"\uD83D\uDC65 Customer Distribution"}),R.customerInsights&&R.customerInsights.totalCustomers>0?(0,o.jsx)("div",{style:{height:"250px"},children:(0,o.jsx)(d.u,{width:"100%",height:"100%",children:(0,o.jsxs)(b.r,{children:[(0,o.jsxs)(y.F,{data:[{name:"New Customers",value:((null==(r=R.customerInsights)?void 0:r.totalCustomers)||0)-((null==(i=R.customerInsights)?void 0:i.returningCustomers)||0),color:"#3b82f6"},{name:"Returning Customers",value:(null==(s=R.customerInsights)?void 0:s.returningCustomers)||0,color:"#10b981"}],cx:"50%",cy:"50%",outerRadius:60,dataKey:"value",label:e=>{let{name:t,percent:r}=e;return"".concat(t,": ").concat((100*r).toFixed(0),"%")},children:[(0,o.jsx)(j.f,{fill:"#3b82f6"}),(0,o.jsx)(j.f,{fill:"#10b981"})]}),(0,o.jsx)(h.m,{formatter:(e,t)=>[T(e),t],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),(0,o.jsx)(u.s,{})]})})}):(0,o.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:[(0,o.jsx)("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"\uD83D\uDC65"}),(0,o.jsx)("p",{children:"No customer data available."})]})]}),(0,o.jsxs)("div",{style:{padding:"1.5rem",background:"#f8fafc",borderRadius:"1rem"},children:[(0,o.jsx)("h4",{style:{margin:"0 0 1rem 0",color:"#1f2937"},children:"\uD83D\uDCCA Customer Insights"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"Average Order Value"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#3b82f6"},children:W((null==(p=R.customerInsights)?void 0:p.avgOrderValue)||0)})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"Retention Rate"}),(0,o.jsxs)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#10b981"},children:[((null==(v=R.customerInsights)?void 0:v.retentionRate)||0).toFixed(1),"%"]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"Total Customers"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#f59e0b"},children:T((null==(S=R.customerInsights)?void 0:S.totalCustomers)||0)})]})]})]})]}),k&&k.length>0&&(0,o.jsxs)("div",{style:{padding:"1.5rem",background:"#f8fafc",borderRadius:"1rem"},children:[(0,o.jsx)("h4",{style:{margin:"0 0 1rem 0",color:"#1f2937"},children:"\uD83D\uDCC8 Customer Behavior Trends"}),(0,o.jsx)("div",{style:{height:"300px",width:"100%"},children:(0,o.jsx)(d.u,{width:"100%",height:"100%",children:(0,o.jsxs)(x.E,{data:k,margin:{top:20,right:30,left:20,bottom:20},children:[(0,o.jsx)(a.d,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),(0,o.jsx)(c.W,{dataKey:"period",tickFormatter:N,stroke:"#6b7280",fontSize:12}),(0,o.jsx)(m.h,{stroke:"#6b7280",fontSize:12}),(0,o.jsx)(h.m,{formatter:(e,t)=>[e,"newCustomers"===t?"New Customers":"Returning Customers"],labelFormatter:e=>"Period: ".concat(N(e)),contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"}}),(0,o.jsx)(u.s,{}),(0,o.jsx)(f.y,{dataKey:"newCustomers",fill:"#3b82f6",name:"New Customers",radius:[2,2,0,0]}),(0,o.jsx)(f.y,{dataKey:"returningCustomers",fill:"#10b981",name:"Returning Customers",radius:[2,2,0,0]})]})})})]})]})]}),(0,o.jsxs)("div",{style:{padding:"1rem",background:"#dbeafe",borderRadius:"0.5rem",fontSize:"0.875rem",color:"#1e40af"},children:[(0,o.jsx)("strong",{children:"\uD83C\uDFAF Smart Analytics:"}),(0,o.jsxs)("div",{style:{marginTop:"0.25rem",fontSize:"0.75rem"},children:["Generated from ",D.length," sales periods, ",k.length," customer periods, and ",w.length," products"]})]})]})}function S(){let{user:e}=(0,s.A)(),[t,r]=(0,n.useState)({firstName:"",lastName:"",email:"",storeName:"",shopDomain:"",accessToken:""}),[i,d]=(0,n.useState)(!1),[l,a]=(0,n.useState)("");(0,n.useEffect)(()=>{if(e){var t,o;r({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",storeName:(null==(t=e.tenant)?void 0:t.name)||"",shopDomain:(null==(o=e.tenant)?void 0:o.domain)||"",accessToken:""})}},[e]);let c=async()=>{console.log("\uD83D\uDD27 Update button clicked!"),d(!0),a("\uD83D\uDD04 Updating store settings...");try{let e=localStorage.getItem("token");if(console.log("\uD83D\uDD27 Token found:",e?"Yes":"No"),!e){a("❌ Authentication token not found. Please login again."),d(!1);return}if(!t.shopDomain||!t.accessToken){a("❌ Please fill in both store domain and access token"),d(!1);return}console.log("\uD83D\uDD27 Making API call with data:",{shopDomain:t.shopDomain,accessToken:t.accessToken?"Present":"Missing"});let r=await fetch("http://localhost:3001/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({shopDomain:t.shopDomain,accessToken:t.accessToken})});console.log("\uD83D\uDD27 API Response status:",r.status);let o=await r.json();console.log("\uD83D\uDD27 API Response data:",o),r.ok?a("✅ Store settings updated successfully!"):a("❌ Failed to update settings: ".concat(o.message||"Unknown error"))}catch(e){console.error("\uD83D\uDD27 API Error:",e),a("❌ Error updating settings: ".concat(e.message))}finally{d(!1),setTimeout(()=>a(""),5e3)}};return(0,o.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"2rem"},children:[(0,o.jsx)("div",{style:{marginBottom:"2rem"},children:(0,o.jsx)("button",{onClick:()=>window.location.reload(),style:{background:"#6b7280",color:"white",border:"none",borderRadius:"0.5rem",padding:"0.75rem 1.5rem",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600"},children:"← Back to Dashboard"})}),(0,o.jsxs)("div",{style:{marginBottom:"2rem",textAlign:"center"},children:[(0,o.jsx)("h1",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"#1f2937",marginBottom:"0.5rem"},children:"⚙️ Account Settings"}),(0,o.jsx)("p",{style:{color:"#6b7280",fontSize:"1.1rem"},children:"Your account information and store configuration"})]}),l&&(0,o.jsx)("div",{style:{marginBottom:"2rem",padding:"1rem",borderRadius:"0.5rem",background:l.includes("✅")?"#d1fae5":l.includes("\uD83D\uDD04")?"#fef3c7":"#fee2e2",color:l.includes("✅")?"#065f46":l.includes("\uD83D\uDD04")?"#92400e":"#dc2626",textAlign:"center",fontWeight:"600"},children:l}),(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:[(0,o.jsxs)("div",{style:{marginBottom:"2rem",paddingBottom:"2rem",borderBottom:"1px solid #e5e7eb"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937",marginBottom:"1.5rem"},children:"\uD83D\uDC64 Personal Information"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"First Name"}),(0,o.jsx)("input",{type:"text",value:t.firstName,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",background:"#f9fafb",color:"#6b7280",cursor:"not-allowed"}})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Last Name"}),(0,o.jsx)("input",{type:"text",value:t.lastName,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",background:"#f9fafb",color:"#6b7280",cursor:"not-allowed"}})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Email Address"}),(0,o.jsx)("input",{type:"email",value:t.email,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",background:"#f9fafb",color:"#6b7280",cursor:"not-allowed"}})]}),(0,o.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Store Name"}),(0,o.jsx)("input",{type:"text",value:t.storeName,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",background:"#f9fafb",color:"#6b7280",cursor:"not-allowed"}})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937",marginBottom:"1.5rem"},children:"\uD83C\uDFEA Store Configuration"}),(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsxs)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:["Shopify Store Domain ",(0,o.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,o.jsx)("input",{type:"text",value:t.shopDomain,onChange:e=>{console.log("\uD83D\uDD27 Store domain changed:",e.target.value),r({...t,shopDomain:e.target.value})},placeholder:"mystore.myshopify.com",style:{width:"100%",padding:"0.75rem",border:"2px solid #3b82f6",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"}}),(0,o.jsx)("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:"Your Shopify store domain (e.g., mystore.myshopify.com)"})]}),(0,o.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,o.jsxs)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:["Admin API Access Token ",(0,o.jsx)("span",{style:{color:"#ef4444"},children:"*"})]}),(0,o.jsx)("input",{type:"password",value:t.accessToken,onChange:e=>{console.log("\uD83D\uDD27 Access token changed"),r({...t,accessToken:e.target.value})},placeholder:"shpat_...",style:{width:"100%",padding:"0.75rem",border:"2px solid #3b82f6",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"}}),(0,o.jsx)("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:"Your Shopify Admin API access token (starts with shpat_)"})]}),(0,o.jsx)("div",{style:{textAlign:"center"},children:(0,o.jsx)("button",{onClick:c,disabled:i,style:{background:i?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"0.75rem",padding:"1rem 2rem",fontSize:"1rem",fontWeight:"600",cursor:i?"not-allowed":"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{i||(e.target.style.background="#059669")},onMouseLeave:e=>{i||(e.target.style.background="#10b981")},children:i?"⏳ Updating...":"\uD83D\uDCBE Update Store Settings"})}),(0,o.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f3f4f6",borderRadius:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[(0,o.jsx)("strong",{children:"Debug Info:"}),(0,o.jsx)("br",{}),"Store Domain: ",t.shopDomain||"Not set",(0,o.jsx)("br",{}),"Access Token: ",t.accessToken?"Set (Hidden)":"Not set",(0,o.jsx)("br",{}),"User Email: ",t.email||"Not loaded"]})]})]})]})}let D="http://localhost:3001";function k(){var e,t;let{isAuthenticated:r,loading:d,user:l,logout:a,getAuthHeaders:c}=(0,s.A)(),[m,h]=(0,n.useState)({totalCustomers:0,totalProducts:0,totalOrders:0,totalRevenue:0}),[u,g]=(0,n.useState)([]),[x,f]=(0,n.useState)([]),[b,y]=(0,n.useState)({totalAbandoned:0,checkoutsStarted:0,checkoutsCompleted:0,abandonmentRate:0,conversionRate:0,lostRevenue:0}),[j,k]=(0,n.useState)({sales:[],customers:[],products:[]}),[w,C]=(0,n.useState)({isOpen:!1,customers:[],loading:!1,pagination:{page:1,limit:20,total:0,totalPages:0,hasNext:!1,hasPrev:!1},search:""}),[R,z]=(0,n.useState)({start:"",end:""}),[A,I]=(0,n.useState)(!1),[B,W]=(0,n.useState)(""),[T,N]=(0,n.useState)(!1),O=(0,i.useRouter)(),P=(null==l?void 0:l.tenantId)||"1",E=async()=>{try{var e,t,r;let o=["".concat(D,"/api/analytics/sales-performance?tenantId=").concat(P),"".concat(D,"/api/analytics/customer-behavior?tenantId=").concat(P),"".concat(D,"/api/analytics/product-performance?tenantId=").concat(P)],[n,i,s]=await Promise.allSettled([fetch(o[0]).then(e=>e.ok?e.json():{success:!1}),fetch(o[1]).then(e=>e.ok?e.json():{success:!1}),fetch(o[2]).then(e=>e.ok?e.json():{success:!1})]),d="fulfilled"===n.status&&(null==(e=n.value)?void 0:e.success)?n.value.data:[],l="fulfilled"===i.status&&(null==(t=i.value)?void 0:t.success)?i.value.data:[],a="fulfilled"===s.status&&(null==(r=s.value)?void 0:r.success)?s.value.data:[];k({sales:Array.isArray(d)?d:[],customers:Array.isArray(l)?l:[],products:Array.isArray(a)?a:[]})}catch(e){k({sales:[],customers:[],products:[]})}},F=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";C(e=>({...e,loading:!0}));try{let r="".concat(D,"/api/customers/list?tenantId=").concat(P,"&page=").concat(e,"&limit=20&search=").concat(encodeURIComponent(t)),o=await fetch(r),n=await o.json();n.success?C(e=>({...e,customers:n.data,pagination:n.pagination,search:t,loading:!1})):C(e=>({...e,loading:!1}))}catch(e){C(e=>({...e,loading:!1}))}},L=async()=>{I(!0);try{await Promise.allSettled([_(),U(),M(),K(),E()])}catch(e){console.error("Error loading data:",e)}finally{I(!1)}},_=async()=>{try{let e=await fetch("".concat(D,"/api/dashboard/").concat(P),{headers:c()}),t=await e.json();t.success&&t.stats?h(t.stats):h({totalCustomers:0,totalProducts:0,totalOrders:0,totalRevenue:0})}catch(e){h({totalCustomers:0,totalProducts:0,totalOrders:0,totalRevenue:0})}},U=async()=>{try{let e="".concat(D,"/api/analytics/orders-by-date?tenantId=").concat(P);R.start&&R.end&&(e+="&startDate=".concat(R.start,"&endDate=").concat(R.end));let t=await fetch(e),r=await t.json();r.success&&g(r.data||[])}catch(e){g([])}},M=async()=>{try{let e=await fetch("".concat(D,"/api/analytics/top-customers?tenantId=").concat(P)),t=await e.json();t.success&&Array.isArray(t.data)?f(t.data):f([])}catch(e){f([])}},K=async()=>{try{let e="".concat(D,"/api/analytics/cart-abandonment?tenantId=").concat(P);R.start&&R.end&&(e+="&startDate=".concat(R.start,"&endDate=").concat(R.end));let t=await fetch(e),r=await t.json();if(r.success){let e=r.summary||{total_abandoned:0,total_completed:0,total_started:0,abandonment_rate:0,abandoned_value:0},t=e.total_started>0?Math.round(e.total_completed/e.total_started*1e4)/100:0;y({totalAbandoned:e.total_abandoned||0,checkoutsStarted:e.total_started||0,checkoutsCompleted:e.total_completed||0,abandonmentRate:e.abandonment_rate||0,conversionRate:t,lostRevenue:e.abandoned_value||0})}else y({totalAbandoned:0,checkoutsStarted:0,checkoutsCompleted:0,abandonmentRate:0,conversionRate:0,lostRevenue:0})}catch(e){y({totalAbandoned:0,checkoutsStarted:0,checkoutsCompleted:0,abandonmentRate:0,conversionRate:0,lostRevenue:0})}},Y=async(e,t)=>{W("\uD83D\uDD04 Syncing ".concat(t,"..."));try{let r=await fetch("".concat(D,"/api/sync/").concat(e),{method:"POST",headers:{"Content-Type":"application/json",...c()},body:JSON.stringify({tenantId:P})});(await r.json()).success?(W("✅ ".concat(t," synced successfully!")),setTimeout(()=>{L(),setTimeout(()=>W(""),3e3)},1e3)):W("❌ ".concat(t," sync failed"))}catch(e){W("❌ ".concat(t," sync failed"))}};return((0,n.useEffect)(()=>{if(!d&&!r())return void O.push("/login");r()&&L()},[d,r,P]),(0,n.useEffect)(()=>{r()&&(U(),K())},[R,P]),d)?(0,o.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"\uD83D\uDED2"}),(0,o.jsx)("h1",{style:{fontSize:"1.5rem",opacity:.8},children:"Loading Xeno Analytics..."})]})}):r()?(0,o.jsxs)("div",{style:{minHeight:"100vh",background:"#f8fafc"},children:[(0,o.jsxs)("nav",{style:{position:"sticky",top:0,zIndex:1e3,background:"#2563eb",color:"white",padding:"1rem 2rem",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,o.jsx)("div",{style:{background:"white",padding:"0.5rem",borderRadius:"0.5rem"},children:(0,o.jsx)("span",{style:{fontSize:"1.5rem",color:"#2563eb"},children:"\uD83D\uDED2"})}),(0,o.jsx)("h1",{style:{fontSize:"1.25rem",fontWeight:"bold",margin:0},children:"Xeno Analytics"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,o.jsxs)("span",{style:{fontSize:"0.875rem"},children:["Store: ",(null==l||null==(e=l.tenant)?void 0:e.name)||"techmart-dev-store".concat("1"===P?"":P)]}),(0,o.jsx)("div",{style:{width:"2rem",height:"2rem",background:"rgba(255,255,255,0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold"},children:null==l||null==(t=l.email)?void 0:t.charAt(0).toUpperCase()}),(0,o.jsx)("button",{onClick:a,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",padding:"0.5rem",borderRadius:"0.25rem",cursor:"pointer"},children:"\uD83D\uDEAA"})]})]}),T&&(0,o.jsx)("div",{style:{marginBottom:"2rem"},children:(0,o.jsx)(S,{})}),!T&&(0,o.jsxs)("div",{style:{display:"flex"},children:[(0,o.jsx)("div",{style:{position:"sticky",top:"80px",height:"calc(100vh - 80px)",width:"4rem",background:"white",borderRight:"1px solid #e5e7eb",padding:"2rem 0"},children:(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2rem"},children:["\uD83D\uDCCA","\uD83D\uDC65","\uD83C\uDFAF","⚙️"].map((e,t)=>(0,o.jsx)("div",{onClick:()=>{3===t&&N(!0)},style:{width:"2.5rem",height:"2.5rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"0.5rem",background:0===t?"#e0f2fe":"transparent",color:0===t?"#0284c7":"#6b7280",cursor:"pointer",fontSize:"1.25rem"},children:e},t))})}),(0,o.jsxs)("div",{style:{flex:1,padding:"2rem"},children:[(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{onClick:()=>{C(e=>({...e,isOpen:!0})),F(1,"")},style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",cursor:"pointer",transition:"all 0.2s ease",position:"relative"},children:[(0,o.jsxs)("h3",{style:{fontSize:"1rem",color:"#6b7280",margin:"0 0 1rem 0",fontWeight:"500"},children:["Total Customers ",(0,o.jsx)("span",{style:{fontSize:"0.75rem",color:"#3b82f6",marginLeft:"0.5rem",fontWeight:"bold"},children:"(Click to view list)"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,o.jsx)("div",{style:{width:"3rem",height:"3rem",background:"#3b82f6",borderRadius:"0.75rem",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.25rem"},children:"\uD83D\uDC65"}),(0,o.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#1f2937"},children:A?"...":((null==m?void 0:m.totalCustomers)||0).toLocaleString()})]}),(0,o.jsx)("div",{style:{position:"absolute",top:"1rem",right:"1rem",fontSize:"0.875rem",color:"#3b82f6"},children:"\uD83D\uDC46"})]}),(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h3",{style:{fontSize:"1rem",color:"#1f2937",margin:"0 0 1rem 0",fontWeight:"600"},children:"\uD83D\uDED2 Cart Events"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,o.jsxs)("div",{style:{background:"#3b82f6",color:"white",padding:"0.5rem 0.75rem",borderRadius:"0.25rem",fontSize:"0.75rem",fontWeight:"600",display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)("span",{children:"Started"}),(0,o.jsx)("span",{children:b.checkoutsStarted})]}),(0,o.jsxs)("div",{style:{background:"#f59e0b",color:"white",padding:"0.5rem 0.75rem",borderRadius:"0.25rem",fontSize:"0.75rem",fontWeight:"600",display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)("span",{children:"Abandoned"}),(0,o.jsx)("span",{children:b.totalAbandoned})]}),(0,o.jsxs)("div",{style:{background:"#10b981",color:"white",padding:"0.5rem 0.75rem",borderRadius:"0.25rem",fontSize:"0.75rem",fontWeight:"600",display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)("span",{children:"Completed"}),(0,o.jsx)("span",{children:b.checkoutsCompleted})]}),(0,o.jsxs)("div",{style:{fontSize:"0.75rem",marginTop:"0.5rem",display:"flex",flexDirection:"column",gap:"0.25rem"},children:[(0,o.jsxs)("div",{style:{color:"#dc2626",fontWeight:"bold"},children:["Abandonment: ",b.abandonmentRate,"%"]}),(0,o.jsxs)("div",{style:{color:"#16a34a",fontWeight:"bold"},children:["Conversion: ",b.conversionRate,"%"]})]})]})]})]}),(0,o.jsx)("div",{style:{marginBottom:"2rem"},children:(0,o.jsx)(p,{apiData:u,startDate:R.start,endDate:R.end,setStartDate:e=>z(t=>({...t,start:e})),setEndDate:e=>z(t=>({...t,end:e})),isLoading:A})}),(0,o.jsx)(v,{salesData:j.sales,customerData:j.customers,productData:j.products,isLoading:A}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h3",{style:{fontSize:"1rem",color:"#6b7280",margin:"0 0 1rem 0",fontWeight:"500"},children:"Total Orders"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,o.jsx)("div",{style:{width:"3rem",height:"3rem",background:"#10b981",borderRadius:"0.75rem",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.25rem"},children:"\uD83D\uDCE6"}),(0,o.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#1f2937"},children:A?"...":((null==m?void 0:m.totalOrders)||0).toLocaleString()})]})]}),(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h3",{style:{fontSize:"1rem",color:"#6b7280",margin:"0 0 1rem 0",fontWeight:"500"},children:"Total Revenue"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,o.jsx)("div",{style:{width:"3rem",height:"3rem",background:"#8b5cf6",borderRadius:"0.75rem",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.25rem"},children:"\uD83D\uDCB0"}),(0,o.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#1f2937"},children:["₹",A?"...":((null==m?void 0:m.totalRevenue)||0).toLocaleString()]})]})]})]}),(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"2rem"},children:[(0,o.jsx)("h3",{style:{fontSize:"1.125rem",color:"#1f2937",margin:"0 0 1.5rem 0",fontWeight:"600"},children:"\uD83C\uDFC6 Top 5 Customers by Spend"}),x&&Array.isArray(x)&&x.length>0?(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:x.slice(0,5).map((e,t)=>(0,o.jsxs)("div",{style:{background:"#f8fafc",padding:"1rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,o.jsx)("div",{style:{width:"1.5rem",height:"1.5rem",borderRadius:"50%",background:0===t?"#fbbf24":1===t?"#9ca3af":2===t?"#cd7c2f":"#e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold",color:t<3?"white":"#6b7280"},children:t+1}),(0,o.jsx)("div",{style:{fontWeight:"600",fontSize:"0.875rem",color:"#1f2937"},children:(null==e?void 0:e.name)||(null==e?void 0:e.email)||"Unknown Customer"})]}),(0,o.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#16a34a"},children:["$",((null==e?void 0:e.totalSpent)||0).toFixed(2)]}),(0,o.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[(null==e?void 0:e.ordersCount)||0," orders"]})]},(null==e?void 0:e.id)||t))}):(0,o.jsxs)("div",{style:{textAlign:"center",color:"#6b7280",padding:"2rem"},children:[(0,o.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem",opacity:.5},children:"\uD83D\uDC65"}),(0,o.jsx)("p",{children:"No customer data available."}),(0,o.jsx)("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:A?"Loading customers...":"Click sync to load data."})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",flexWrap:"wrap"},children:[(0,o.jsxs)("button",{onClick:()=>N(!T),style:{padding:"0.75rem 1.5rem",border:"none",borderRadius:"0.75rem",background:"#6b7280",color:"white",fontWeight:"600",fontSize:"0.875rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("span",{children:"⚙️"}),"SETTINGS"]}),[{endpoint:"customers",label:"SYNC CUSTOMERS",icon:"\uD83D\uDC65"},{endpoint:"products",label:"SYNC PRODUCTS",icon:"\uD83D\uDCE6"},{endpoint:"orders",label:"SYNC ORDERS",icon:"\uD83D\uDECD️"},{endpoint:"all",label:"SYNC ALL",icon:"⚡"}].map(e=>(0,o.jsxs)("button",{onClick:()=>Y(e.endpoint,e.label.split(" ")[1]),style:{padding:"0.75rem 1.5rem",border:"none",borderRadius:"0.75rem",background:"#3b82f6",color:"white",fontWeight:"600",fontSize:"0.875rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("span",{children:e.icon}),e.label]},e.endpoint))]}),B&&(0,o.jsx)("div",{style:{marginTop:"1rem",textAlign:"center",padding:"1rem",background:"white",borderRadius:"0.75rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontSize:"1rem",fontWeight:"600"},children:B})]})]}),w.isOpen&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:"1rem",padding:"2rem",width:"90%",maxWidth:"1000px",maxHeight:"80vh",overflow:"hidden",boxShadow:"0 25px 50px rgba(0,0,0,0.25)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"2px solid #e5e7eb"},children:[(0,o.jsxs)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937",margin:0},children:["\uD83D\uDC65 Customer List (",w.pagination.total," customers)"]}),(0,o.jsx)("button",{onClick:()=>{C(e=>({...e,isOpen:!1,customers:[],search:"",pagination:{page:1,limit:20,total:0,totalPages:0,hasNext:!1,hasPrev:!1}}))},style:{background:"#ef4444",color:"white",border:"none",borderRadius:"0.5rem",padding:"0.5rem 1rem",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600"},children:"✕ Close"})]}),(0,o.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,o.jsx)("input",{type:"text",placeholder:"\uD83D\uDD0D Search customers by name or email...",value:w.search,onChange:e=>{let t=e.target.value;C(e=>({...e,search:t})),setTimeout(()=>{w.search===t&&F(1,t)},500)},style:{width:"100%",padding:"0.75rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"1rem",outline:"none"}})}),(0,o.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:"0.5rem"},children:w.loading?(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"⏳"}),(0,o.jsx)("p",{children:"Loading customers..."})]})}):w.customers.length>0?(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#f8fafc"},children:[(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Customer"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Email"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid #e5e7eb"},children:"Total Spent"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid #e5e7eb"},children:"Orders"})]})}),(0,o.jsx)("tbody",{children:w.customers.map(e=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[(0,o.jsx)("td",{style:{padding:"0.75rem"},children:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("div",{style:{width:"2rem",height:"2rem",borderRadius:"50%",background:"#3b82f6",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold"},children:e.name.charAt(0).toUpperCase()}),(0,o.jsx)("span",{style:{fontWeight:"600"},children:e.name})]})}),(0,o.jsx)("td",{style:{padding:"0.75rem",fontSize:"0.875rem"},children:e.email}),(0,o.jsxs)("td",{style:{padding:"0.75rem",textAlign:"right",fontWeight:"bold",color:"#16a34a"},children:["$",e.totalSpent.toFixed(2)]}),(0,o.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",fontWeight:"600"},children:e.ordersCount})]},e.id))})]}):(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",flexDirection:"column"},children:[(0,o.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\uD83D\uDC65"}),(0,o.jsx)("p",{style:{color:"#6b7280"},children:"No customers found"})]})})]})})]}):null}},9858:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,AuthProvider:()=>s});var o=r(5155),n=r(2115);let i=(0,n.createContext)();function s(e){let{children:t}=e,[r,s]=(0,n.useState)(null),[d,l]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=localStorage.getItem("xeno_user");e&&s(JSON.parse(e)),l(!1)},[]);let a=async e=>{let t={email:e.email,tenantId:e.tenantId,tenantName:e.tenantName,tenantDomain:e.tenantDomain,loginTime:new Date().toISOString()};return s(t),localStorage.setItem("xeno_user",JSON.stringify(t)),{success:!0}};return(0,o.jsx)(i.Provider,{value:{user:r,loading:d,login:a,logout:()=>{s(null),localStorage.removeItem("xeno_user")},isAuthenticated:()=>!!r,getAuthHeaders:()=>({"Content-Type":"application/json","X-User-Email":(null==r?void 0:r.email)||"","X-Tenant-ID":(null==r?void 0:r.tenantId)||"1"})},children:t})}let d=()=>{let e=(0,n.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[379,441,255,358],()=>e(e.s=1774)),_N_E=e.O()}]);